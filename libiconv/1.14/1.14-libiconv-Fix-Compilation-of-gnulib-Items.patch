From 7bb908bfadc34fe703e0758b4d1bbb86eccaed48 Mon Sep 17 00:00:00 2001
From: Chun-wei Fan <fanchunwei@src.gnome.org>
Date: Tue, 12 May 2015 12:09:26 +0800
Subject: [PATCH] libiconv: Fix Compilation of gnulib Items

Include windows.h and ensure that things are properly defined.
---
 srclib/canonicalize-lgpl.c | 7 +++++++
 srclib/stat.c              | 6 ++++++
 2 files changed, 13 insertions(+)

diff --git a/srclib/canonicalize-lgpl.c b/srclib/canonicalize-lgpl.c
index 2755df9..b740ea9 100644
--- a/srclib/canonicalize-lgpl.c
+++ b/srclib/canonicalize-lgpl.c
@@ -40,6 +40,13 @@
 #include <errno.h>
 #include <stddef.h>
 
+#ifdef _MSC_VER
+#define WIN32_LEAN_AND_MEAN
+#include <windows.h>
+
+#define PATH_MAX MAX_PATH
+#endif
+
 #ifdef _LIBC
 # include <shlib-compat.h>
 #else
diff --git a/srclib/stat.c b/srclib/stat.c
index f07370d..64d6f89 100644
--- a/srclib/stat.c
+++ b/srclib/stat.c
@@ -40,6 +40,12 @@ orig_stat (const char *filename, struct stat *buf)
 #include "dosname.h"
 #include "verify.h"
 
+#ifdef _MSC_VER
+#define WIN32_LEAN_AND_MEAN
+#include <windows.h>
+#define PATH_MAX MAX_PATH
+#endif
+
 /* Store information about NAME into ST.  Work around bugs with
    trailing slashes.  Mingw has other bugs (such as st_ino always
    being 0 on success) which this wrapper does not work around.  But
-- 
2.3.5.windows.8

